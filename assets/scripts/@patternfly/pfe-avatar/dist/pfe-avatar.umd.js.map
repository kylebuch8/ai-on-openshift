{"version":3,"file":"pfe-avatar.umd.js","sources":["../_temp/djb-hash.js","../_temp/hslrgb.js","../_temp/pfe-avatar.umd.js"],"sourcesContent":["/**\n * djb2 string hashing function.\n *\n * @see http://www.cse.yorku.ca/~oz/hash.html\n * @param {String} str the string to hash.\n * @return {Number} a positive integer\n */\n\nfunction hash(str) {\n  let hash = 5381;\n  let i = str.length;\n\n  while (i) {\n    hash = (hash * 33) ^ str.charCodeAt(--i);\n  }\n\n  return hash >>> 0;\n}\n\nexport { hash };\n","function h2rgb(v1, v2, vH) {\n  if (vH < 0) vH += 1;\n  if (vH > 1) vH -= 1;\n  if (6 * vH < 1) return v1 + (v2 - v1) * 6 * vH;\n  if (2 * vH < 1) return v2;\n  if (3 * vH < 2) return v1 + (v2 - v1) * (2 / 3 - vH) * 6;\n  return v1;\n}\n\n/**\n * Convert an HSL color to RGB.\n *\n * @param {Number} H the hue component\n * @param {Number} S the saturation component\n * @param {Number} L the luminance component\n * @return {Array} [R, G, B]\n *\n * @see https://www.easyrgb.com/en/math.php\n */\nexport function hsl2rgb(_H, _S, _L) {\n  let R, G, B;\n\n  const H = Math.max(0, Math.min(1, _H));\n  const S = Math.max(0, Math.min(1, _S));\n  const L = Math.max(0, Math.min(1, _L));\n\n  if (S == 0) {\n    R = L * 255;\n    G = L * 255;\n    B = L * 255;\n  } else {\n    let a, b;\n\n    if (L < 0.5) {\n      b = L * (1 + S);\n    } else {\n      b = L + S - S * L;\n    }\n\n    a = 2 * L - b;\n\n    R = Math.floor(255 * h2rgb(a, b, H + 1 / 3));\n    G = Math.floor(255 * h2rgb(a, b, H));\n    B = Math.floor(255 * h2rgb(a, b, H - 1 / 3));\n  }\n\n  return [R, G, B];\n}\n\n/**\n * Convert an RGBcolor to HSL.\n *\n * @param {Number} R the red component\n * @param {Number} G the green component\n * @param {Number} B the blue component\n * @return {Array} [H, S, L]\n *\n * @see https://www.easyrgb.com/en/math.php\n */\nexport function rgb2hsl(_R, _G, _B) {\n  let H, S, L;\n\n  const R = Math.max(0, Math.min(255, _R));\n  const G = Math.max(0, Math.min(255, _G));\n  const B = Math.max(0, Math.min(255, _B));\n\n  const r = R / 255;\n  const g = G / 255;\n  const b = B / 255;\n\n  const var_min = Math.min(Math.min(r, g), b);\n  const var_max = Math.max(Math.max(r, g), b);\n  const del_max = var_max - var_min;\n\n  L = (var_max + var_min) / 2;\n\n  if (del_max === 0) {\n    H = 0;\n    S = 0;\n  } else {\n    if (L < 0.5) {\n      S = del_max / (var_max + var_min);\n    } else {\n      S = del_max / (2 - var_max - var_min);\n    }\n\n    const del_r = ((var_max - r) / 6 + del_max / 2) / del_max;\n    const del_g = ((var_max - g) / 6 + del_max / 2) / del_max;\n    const del_b = ((var_max - b) / 6 + del_max / 2) / del_max;\n\n    if (r == var_max) {\n      H = del_b - del_g;\n    } else if (g == var_max) {\n      H = 1 / 3 + del_r - del_b;\n    } else if (b == var_max) {\n      H = 2 / 3 + del_g - del_r;\n    }\n\n    if (H < 0) {\n      H += 1;\n    } else if (H > 1) {\n      H -= 1;\n    }\n  }\n\n  return [H, S, L];\n}\n","/*!\n * PatternFly Elements: PfeAvatar 1.12.3\n * @license\n * Copyright 2021 Red Hat, Inc.\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * \n*/\n\nimport PFElement from \"../../pfelement/dist/pfelement\";\nimport { hash } from \"./djb-hash.js\";\nimport { hsl2rgb, rgb2hsl } from \"./hslrgb.js\";\n\nclass PfeAvatar extends PFElement {\n\n  // Injected at build-time\n  static get version() {\n    return \"1.12.3\";\n  }\n\n  // Injected at build-time\n  get html() {\n    return `\n<style>:host{display:block;position:relative;width:128px;width:var(--pfe-avatar--size,var(--pfe-avatar--width,128px));height:128px;height:var(--pfe-avatar--size,var(--pfe-avatar--width,128px))}:host canvas{width:100%;height:100%;image-rendering:optimizeSpeed;image-rendering:-moz-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:-o-crisp-edges;image-rendering:-o-pixelated;image-rendering:pixelated;-ms-interpolation-mode:nearest-neighbor}:host([shape=rounded]) canvas,:host([shape=rounded]) img{border-radius:calc(128px / 8 + 1px);border-radius:calc(var(--pfe-avatar--size,var(--pfe-avatar--width,128px))/ 8 + 1px)}:host([shape=circle]) canvas,:host([shape=circle]) img{border-radius:50%}:host([src]) canvas{display:none}:host([src]) img{display:block;width:100%;height:100%;-o-object-fit:cover;object-fit:cover}:host(:not([src])) img{display:none}:host([hidden]){display:none} /*# sourceMappingURL=pfe-avatar.min.css.map */</style>\n<canvas></canvas>\n<img>`;\n  }\n\n  static get tag() {\n    return \"pfe-avatar\";\n  }\n\n  static get properties() {\n    return {\n      name: {\n        title: \"Username\",\n        type: String,\n        default: \"\",\n        observer: \"_updateWhenConnected\",\n      },\n      src: {\n        title: \"Avatar image URL\",\n        type: String,\n        observer: \"_updateWhenConnected\",\n      },\n      pattern: {\n        title: \"Shape pattern\",\n        type: String,\n        default: PfeAvatar.patterns.squares,\n        observer: \"_updateWhenConnected\",\n      },\n      // @TODO Deprecated pfe-name in 1.0\n      oldName: {\n        alias: \"name\",\n        attr: \"pfe-name\",\n      },\n      // @TODO Deprecated pfe-src in 1.0\n      oldSrc: {\n        alias: \"src\",\n        attr: \"pfe-src\",\n      },\n      // @TODO Deprecated pfe-pattern in 1.0\n      oldPattern: {\n        alias: \"pattern\",\n        attr: \"pfe-pattern\",\n      },\n    };\n  }\n\n  get templateUrl() {\n    return \"pfe-avatar.html\";\n  }\n\n  get styleUrl() {\n    return \"pfe-avatar.scss\";\n  }\n\n  static get events() {\n    return {\n      connected: `${this.tag}:connected`,\n    };\n  }\n\n  static get patterns() {\n    return {\n      triangles: \"triangles\",\n      squares: \"squares\",\n    };\n  }\n\n  static get defaultSize() {\n    return 128;\n  }\n\n  static get defaultColors() {\n    return \"#67accf #448087 #709c6b #a35252 #826cbb\";\n  }\n\n  get customColors() {\n    return this.cssVariable(\"pfe-avatar--colors\");\n  }\n\n  constructor() {\n    super(PfeAvatar);\n\n    this._initCanvas = this._initCanvas.bind(this);\n  }\n\n  connectedCallback() {\n    // initCanvas comes before parent's connectedCallback because the\n    // connectedCallback sets attribute values, triggering, the observer\n    // functions, which require the canvas to already be initialized.\n    this._initCanvas();\n\n    super.connectedCallback();\n\n    this.emitEvent(PfeAvatar.events.connected, {\n      bubbles: false,\n    });\n  }\n\n  _initCanvas() {\n    this._canvas = this.shadowRoot.querySelector(\"canvas\");\n    const cssVarWidth = this.cssVariable(\"pfe-avatar--width\");\n    const size = (cssVarWidth && cssVarWidth.replace(/px$/, \"\")) || PfeAvatar.defaultSize;\n    this._canvas.width = size;\n    this._canvas.height = size;\n\n    this._squareSize = this._canvas.width / 8;\n    this._triangleSize = this._canvas.width / 4;\n\n    this._ctx = this._canvas.getContext(\"2d\");\n  }\n\n  static _registerColors() {\n    this.colors = [];\n    const contextColors = this.customColors || this.defaultColors;\n\n    contextColors.split(/\\s+/).forEach((colorCode) => {\n      let pattern;\n      switch (colorCode.length) {\n        case 4: // ex: \"#0fc\"\n          pattern = /^#([A-f0-9])([A-f0-9])([A-f0-9])$/.exec(colorCode);\n          if (pattern) {\n            pattern.shift();\n            const color = pattern.map((c) => parseInt(c + c, 16));\n            this._registerColor(color);\n          } else {\n            this.log(`[pfe-avatar] invalid color ${colorCode}`);\n          }\n          break;\n        case 7: // ex: \"#00ffcc\"\n          pattern = /^#([A-f0-9]{2})([A-f0-9]{2})([A-f0-9]{2})$/.exec(colorCode);\n          if (pattern) {\n            pattern.shift();\n            const color = pattern.map((c) => parseInt(c, 16));\n            this._registerColor(color);\n          } else {\n            this.log(`[pfe-avatar] invalid color ${colorCode}`);\n          }\n      }\n    });\n\n    return this.colors;\n  }\n\n  static _registerColor(color) {\n    PfeAvatar.colors.push({\n      color1: `rgb(${color.join(\",\")})`,\n      color2: `rgb(${this._adjustColor(color).join(\",\")})`,\n    });\n  }\n\n  static _adjustColor(color) {\n    const dark = 0.1;\n    const l_adj = 0.1; // luminance adjustment\n    const hsl = rgb2hsl(...color);\n\n    // if luminance is too dark already, then lighten the alternate color\n    // instead of darkening it.\n    hsl[2] += hsl[2] > dark ? -l_adj : l_adj;\n\n    return hsl2rgb(...hsl);\n  }\n\n  _updateWhenConnected() {\n    if (this.hasAttribute(\"pfelement\")) {\n      this.update();\n    } else {\n      this.addEventListener(PfeAvatar.events.connected, () => this.update());\n    }\n  }\n\n  update() {\n    // if we have a src element, update the img, otherwise update the random pattern\n    if (this.src) {\n      this.shadowRoot.querySelector(\"img\").src = this.src;\n    } else {\n      const bitPattern = hash(this.name).toString(2);\n      const arrPattern = bitPattern.split(\"\").map((n) => Number(n));\n      this._colorIndex = Math.floor((PfeAvatar.colors.length * parseInt(bitPattern, 2)) / Math.pow(2, 32));\n      this.color1 = PfeAvatar.colors[this._colorIndex].color1;\n      this.color2 = PfeAvatar.colors[this._colorIndex].color2;\n\n      this._clear();\n      this._drawBackground();\n      if (this.pattern === PfeAvatar.patterns.squares) {\n        this._drawSquarePattern(arrPattern);\n      } else if (this.pattern === PfeAvatar.patterns.triangles) {\n        this._drawTrianglePattern(arrPattern);\n      }\n      // this._drawGradient();\n    }\n  }\n\n  _clear() {\n    this._ctx.clearRect(0, 0, this._canvas.width, this._canvas.height);\n  }\n\n  _drawBackground() {\n    this._ctx.fillStyle = this.color1;\n    this._ctx.fillRect(0, 0, this._canvas.width, this._canvas.height);\n  }\n\n  _drawSquarePattern(pattern) {\n    this._ctx.fillStyle = this.color2;\n    if (this._ctx) {\n      let i = pattern.length;\n      while (i--) {\n        if (pattern[i]) {\n          this._drawMirroredSquare(i % 4, Math.floor(i / 4));\n        }\n      }\n    }\n  }\n\n  /**\n   * Draw a square at the given position, mirrored onto both the left and right half of the canvas.\n   */\n  _drawMirroredSquare(x, y) {\n    if (this._ctx) {\n      this._drawSquare(x, y);\n      this._drawSquare(7 - x, y);\n    }\n  }\n\n  _drawSquare(x, y) {\n    this._ctx.fillRect(this._squareSize * x, this._squareSize * y, this._squareSize, this._squareSize);\n  }\n\n  _drawTrianglePattern(pattern) {\n    this._ctx.fillStyle = this.color2;\n    if (this._ctx) {\n      let i = pattern.length;\n      while (i--) {\n        if (pattern[i]) {\n          const x = Math.floor(i / 2) % 2;\n          const y = Math.floor(i / 4);\n          const alt = i % 4;\n\n          const p1 = [x, y];\n          const p2 = [x, y];\n          const p3 = [x, y];\n\n          switch (alt) {\n            case 0:\n              p2[1]++;\n              p3[0]++;\n              p3[1]++;\n              break;\n            case 1:\n              p2[0]++;\n              p3[0]++;\n              p3[1]++;\n              break;\n            case 2:\n              p2[0]++;\n              p3[1]++;\n              break;\n            case 3:\n              p1[0]++;\n              p2[0]++;\n              p2[1]++;\n              p3[1]++;\n              break;\n          }\n\n          this._drawMirroredTriangle(p1, p2, p3);\n        }\n      }\n    }\n  }\n\n  /**\n   * Draw a square at the given position in the top-left quadrant of the\n   * canvas, and mirrored to the other three quadrants.\n   */\n  _drawMirroredTriangle(p1, p2, p3) {\n    if (this._ctx) {\n      this._drawTriangle(p1, p2, p3);\n      this._drawTriangle([4 - p1[0], p1[1]], [4 - p2[0], p2[1]], [4 - p3[0], p3[1]]);\n    }\n  }\n\n  _drawTriangle(p1, p2, p3) {\n    this._ctx.beginPath();\n    this._ctx.moveTo(...p1.map((c) => c * this._triangleSize));\n    this._ctx.lineTo(...p2.map((c) => c * this._triangleSize));\n    this._ctx.lineTo(...p3.map((c) => c * this._triangleSize));\n    this._ctx.closePath();\n    this._ctx.fill();\n    this._ctx.fill();\n  }\n\n  _drawGradient() {\n    const gradient = this._ctx.createLinearGradient(0, this._canvas.height, this._canvas.width, 0);\n    const color = this.color2;\n    let gradientColor1 = color;\n    let gradientColor2 = color;\n    if (/^#[A-f0-9]{3}$/.test(color)) {\n      // color is of the form \"#fff\"\n      gradientColor1 += \"c\";\n      gradientColor2 += \"0\";\n    } else if (/^#[A-f0-9]{6}$/.test(color)) {\n      // color is of the form \"#ffffff\"\n      gradientColor1 += \"cc\";\n      gradientColor2 += \"00\";\n    }\n    gradient.addColorStop(0, gradientColor1);\n    gradient.addColorStop(1, gradientColor2);\n    gradient.addColorStop(1, gradientColor1);\n    this._ctx.fillStyle = gradient;\n    this._ctx.fillRect(0, 0, this._canvas.width, this._canvas.height);\n  }\n}\n\nPfeAvatar._registerColors();\n\nPFElement.create(PfeAvatar);\n\nexport default PfeAvatar;\n"],"names":["hash","str","i","length","charCodeAt","h2rgb","v1","v2","vH","hsl2rgb","_H","_S","_L","R","G","B","H","Math","max","min","S","L","a","b","floor","rgb2hsl","_R","_G","_B","r","g","var_min","var_max","del_max","del_r","del_g","del_b","PfeAvatar","cssVariable","name","title","type","String","default","observer","src","pattern","patterns","squares","oldName","alias","attr","oldSrc","oldPattern","connected","tag","triangles","_initCanvas","bind","emitEvent","events","bubbles","_canvas","shadowRoot","querySelector","cssVarWidth","size","replace","defaultSize","width","height","_squareSize","_triangleSize","_ctx","getContext","hasAttribute","update","addEventListener","bitPattern","toString","arrPattern","split","map","n","Number","_colorIndex","colors","parseInt","pow","color1","color2","_clear","_drawBackground","_drawSquarePattern","_drawTrianglePattern","clearRect","fillStyle","fillRect","_drawMirroredSquare","x","y","_drawSquare","alt","p1","p2","p3","_drawMirroredTriangle","_drawTriangle","beginPath","moveTo","c","lineTo","closePath","fill","gradient","createLinearGradient","color","gradientColor1","gradientColor2","test","addColorStop","contextColors","customColors","defaultColors","forEach","colorCode","exec","shift","_registerColor","log","push","join","_adjustColor","dark","l_adj","hsl","PFElement","_registerColors","create"],"mappings":"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"}