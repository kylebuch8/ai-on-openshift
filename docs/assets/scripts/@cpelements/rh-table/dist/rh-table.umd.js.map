{"version":3,"file":"rh-table.umd.js","sources":["../_temp/rh-table.umd.js"],"sourcesContent":["/*!\n * PatternFly Elements: RhTable 0.0.19\n * @license\n * Copyright 2020 Red Hat, Inc.\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * \n*/\n\nimport PFElement from \"../../../@patternfly/pfelement/dist/pfelement.umd\";\n\n// @todo See if there are more a11y features we should take from: https://dequeuniversity.com/library/aria/table-sortable\n// @todo See if <dialog> tag could be useful for the maximized table\n// @todo Bug where fullscreen button doesn't show up sometimes in smaller reflow (hard to replicate)\n// @todo Pagination?\n// @todo Search?\n// @todo move to pfe-tools/pfe 2.0\n// @todo after pfe 2.0 write tests\n//    - Test to make sure full screen button shows up when table scrolls\n//    - Tests for sorting results\n\n/**\n * Debounce helper function\n * @see https://davidwalsh.name/javascript-debounce-function\n *\n * @param {function} func Function to be debounced\n * @param {number} delay How long until it will be run\n * @param {boolean} immediate Whether it should be run at the start instead of the end of the debounce\n */\nfunction debounce(func, delay, immediate = false) {\n  var timeout;\n  return function () {\n    var context = this,\n      args = arguments;\n    var later = function () {\n      timeout = null;\n      if (!immediate) func.apply(context, args);\n    };\n    var callNow = immediate && !timeout;\n    clearTimeout(timeout);\n    timeout = setTimeout(later, delay);\n    if (callNow) func.apply(context, args);\n  };\n}\n\nclass RhTable extends PFElement {\n  static get version() {\n    return \"0.0.19\";\n  }\n\n  get html() {\n    return `<style>*{-webkit-box-sizing:border-box;box-sizing:border-box}:host{position:relative;display:block;width:auto;width:var(--rh-table--wrappers--width,auto)}:host([hidden]){display:none}:host(.rh-table--expanded-vertically){--rh-table--maxHeight:max-content}#wrapper{overflow:auto;width:auto;width:var(--rh-table--wrappers--width,auto);max-width:100%;max-height:-webkit-max-content;max-height:-moz-max-content;max-height:max-content;max-height:var(--rh-table--maxHeight,-webkit-max-content);max-height:var(--rh-table--maxHeight,-moz-max-content);max-height:var(--rh-table--maxHeight,max-content);scrollbar-color:#8e8e8e #d6d6d6}#wrapper::-webkit-scrollbar{width:.625rem;height:.625rem}#wrapper::-webkit-scrollbar,#wrapper::-webkit-scrollbar-track{background-color:#d6d6d6}#wrapper::-webkit-scrollbar-thumb{background-color:#8e8e8e}#wrapper.table-full-screen{position:fixed;top:40px;right:0;bottom:40px;left:0;z-index:1;overflow:scroll;margin:0;width:100%;max-height:90vh;padding:40px;background-color:#fff}@media (min-width:1400px){#wrapper.table-full-screen{padding:40px 160px}}#wrapper.table-full-screen .full-screen{right:40px}.overlay{position:fixed;top:0;left:0;z-index:-1;display:block;width:100%;height:100%;background:rgba(21,21,21,.5);background:var(--pfe-table--overlay--Background,rgba(21,21,21,.5))}.overlay[hidden]{display:none}.visually-hidden{position:absolute;overflow:hidden;clip:rect(0,0,0,0);width:1px;height:1px;padding:0;border:0;white-space:nowrap}button{border:0;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#f0efef;cursor:pointer}button:focus{outline:2px dashed #000;outline:var(--rh-table--button--outline--focus,2px dashed #000)}.rh-table__expand-vertical-button,.rh-table__full-screen-button{position:absolute;right:calc(0px + 8px);right:calc(var(--rh-table--scrollbar--width,0px) + 8px);z-index:1;width:1.75rem;height:1.75rem;padding:6px;color:#8a8a8a;background:#f0efef}:host(.full-screen) .rh-table__expand-vertical-button,:host(.full-screen) .rh-table__full-screen-button{display:none}.rh-table__expand-vertical-button svg,.rh-table__full-screen-button svg{width:1rem;height:1rem}.rh-table__expand-vertical-button:focus,.rh-table__expand-vertical-button:hover,.rh-table__full-screen-button:focus,.rh-table__full-screen-button:hover{color:#06c}.rh-table__expand-vertical-button{top:calc(1.75rem + 8px)}:host(.rh-table--expanded-vertically) .rh-table__expand-vertical-button{background:#2b9af3;color:#fff}.rh-table__expand-vertical-button path,.rh-table__expand-vertical-button svg{fill:currentColor}.rh-table__close-full-screen-button{position:fixed;top:80px;right:40px;z-index:10;display:none;width:2rem;height:2rem;padding:0;background:#f0efef}:host(.full-screen) .rh-table__close-full-screen-button{display:block}.rh-table__close-full-screen-button svg{width:2rem;height:2rem}\n/*# sourceMappingURL=rh-table.min.css.map */\n</style><div id=\"wrapper\">\n  <button class=\"rh-table__sort-button\" hidden title=\"Sort in descending order\">\n    <svg\n      aria-hidden=\"true\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 320 512\"\n    >\n      <path\n        class=\"arrow--up\"\n        d=\"M27.66 224h264.7c24.6 0 36.89-29.78 19.54-47.12l-132.3-136.8c-5.406-5.406-12.47-8.107-19.53-8.107c-7.055 0-14.09 2.701-19.45 8.107L8.119 176.9C-9.229 194.2 3.055 224 27.66 224z\"\n      />\n      <path\n        class=\"arrow--down\"\n        d=\"M311.9 335.1l-132.4 136.8C174.1 477.3 167.1 480 160 480c-7.055 0-14.12-2.702-19.47-8.109l-132.4-136.8C-9.229 317.8 3.055 288 27.66 288h264.7C316.9 288 329.2 317.8 311.9 335.1z\"\n      />\n    </svg>\n  </button>\n  <button class=\"rh-table__full-screen-button full-screen\" hidden title=\"Maximize the table\">\n    <svg\n      aria-hidden=\"true\"\n      focusable=\"false\"\n      data-prefix=\"fas\"\n      data-icon=\"expand-arrows-alt\"\n      class=\"svg-inline--fa fa-expand-arrows-alt fa-w-14\"\n      role=\"img\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 448 512\"\n    >\n      <path\n        fill=\"currentColor\"\n        d=\"M448 344v112a23.94 23.94 0 0 1-24 24H312c-21.39 0-32.09-25.9-17-41l36.2-36.2L224 295.6 116.77 402.9 153 439c15.09 15.1 4.39 41-17 41H24a23.94 23.94 0 0 1-24-24V344c0-21.4 25.89-32.1 41-17l36.19 36.2L184.46 256 77.18 148.7 41 185c-15.1 15.1-41 4.4-41-17V56a23.94 23.94 0 0 1 24-24h112c21.39 0 32.09 25.9 17 41l-36.2 36.2L224 216.4l107.23-107.3L295 73c-15.09-15.1-4.39-41 17-41h112a23.94 23.94 0 0 1 24 24v112c0 21.4-25.89 32.1-41 17l-36.19-36.2L263.54 256l107.28 107.3L407 327.1c15.1-15.2 41-4.5 41 16.9z\"\n      ></path>\n    </svg>\n  </button>\n  <button class=\"rh-table__expand-vertical-button\" hidden title=\"Expand to full height\">\n    <svg\n      aria-hidden=\"true\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 320 512\">\n      <path d=\"M182.6 9.4c-12.5-12.5-32.8-12.5-45.3 0l-96 96c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L128 109.3V402.7L86.6 361.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l96 96c12.5 12.5 32.8 12.5 45.3 0l96-96c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 402.7V109.3l41.4 41.4c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-96-96z\"/>\n    </svg>\n  </button>\n  <slot></slot>\n</div>\n<button class=\"rh-table__close-full-screen-button full-screen--close\" title=\"Restore table to original size\">\n  <svg fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 28 28\">\n    <path fill=\"#F0EFEF\" d=\"M0 0h28v28H0z\" />\n    <g clip-path=\"url(#a)\">\n      <path\n        d=\"M12.25 15h-3.5a.75.75 0 0 0-.531 1.281l1.028.969-3.1 3.103a.502.502 0 0 0 0 .706l.794.794a.502.502 0 0 0 .706 0l3.103-3.103.972 1.031A.749.749 0 0 0 13 19.25v-3.5a.748.748 0 0 0-.75-.75Zm3.5-2h3.5a.751.751 0 0 0 .531-1.281l-1.031-.969 3.103-3.103a.502.502 0 0 0 0-.706l-.794-.794a.502.502 0 0 0-.706 0L17.25 9.25l-.972-1.031A.749.749 0 0 0 15 8.75v3.5c0 .416.334.75.75.75Zm3 4.25 1.031-.972A.749.749 0 0 0 19.25 15h-3.5a.748.748 0 0 0-.75.75v3.5a.751.751 0 0 0 1.281.531l.969-1.028 3.103 3.103a.502.502 0 0 0 .706 0l.794-.794a.502.502 0 0 0 0-.706L18.75 17.25Zm-7.031-9.028-.97 1.028-3.102-3.103a.502.502 0 0 0-.706 0l-.794.794a.502.502 0 0 0 0 .706L9.25 10.75l-1.031.972A.749.749 0 0 0 8.749 13h3.5c.416 0 .75-.334.75-.75v-3.5c0-.666-.809-1-1.28-.528Z\"\n        fill=\"#9B9B9B\"\n      />\n    </g>\n    <defs>\n      <clipPath id=\"a\">\n        <path fill=\"#fff\" transform=\"translate(6 6)\" d=\"M0 0h16v16H0z\" />\n      </clipPath>\n    </defs>\n  </svg>\n</button>\n<div class=\"overlay\" hidden></div>`;\n  }\n\n  static get properties() {\n    return {\"compact-mode\":{\"title\":\"Compact-mode\",\"type\":\"string\",\"enum\":[],\"default\":\"\",\"prefixed\":true},\"sortable-cols\":{\"title\":\"Sortable-cols\",\"type\":\"string\",\"enum\":[],\"default\":\"\",\"prefixed\":true}};\n  }\n\n  static get slots() {\n    return {\"default\":{\"title\":\"Default slot\",\"type\":\"array\",\"namedSlot\":false,\"items\":{\"oneOf\":[{\"$ref\":\"raw\"}]}}};\n  }\n  static get tag() {\n    return \"rh-table\";\n  }\n\n  static get properties() {\n    return {};\n  }\n\n  static get slots() {\n    return {};\n  }\n\n  get schemaUrl() {\n    return \"rh-table.json\";\n  }\n\n  get templateUrl() {\n    return \"rh-table.html\";\n  }\n\n  get styleUrl() {\n    return \"rh-table.scss\";\n  }\n\n  static get events() {\n    return {\n      sorted: `${this.tag}:sorted`,\n    };\n  }\n\n  // Declare the type of this component\n  static get PfeType() {\n    return PFElement.PfeTypes.Content;\n  }\n\n  static get observedAttributes() {\n    return [\"compact-mode\", \"sortable-cols\"];\n  }\n\n  constructor() {\n    super(RhTable, { type: RhTable.PfeType });\n    // NO DOM ACCESS\n\n    this.table = null;\n    this._shadowWrapper = this.shadowRoot.getElementById(\"wrapper\");\n    this.canFullScreen = true;\n    this.isFullscreen = false;\n    this._fullScreenButton =\n      this.shadowRoot.querySelector(\".rh-table__full-screen-button\");\n    this._expandButton = this.shadowRoot.querySelector('.rh-table__expand-vertical-button')\n    this._fullScreenCloseButton = this.shadowRoot.querySelector(\".rh-table__close-full-screen-button\");\n    this._overlay = this.shadowRoot.querySelector(\".overlay\");\n    this._expandUnpressed = true;\n    this.hovered = {\n      hoveredCoordinates: null,\n      styleElement: null,\n      styleSheet: null,\n      checkInterval: null,\n    };\n\n    this.docLang;\n    this._sortHeadings = null;\n    this.tableSortValues = { heading: [], values: [] };\n    this.tableCellValues = {};\n    this.sortable = null;\n    this.lastSortCol = null;\n    this.resizeDebounce = 250;\n    this.sortOrder = \"az\";\n\n    // Used to trap focus in maximized table\n    this._focusableElements =\n      'button, a[href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])';\n    // Used to track\n    this._previousFirstFocusableElement = null;\n    this._focusTrapCallbacks = {\n      first: null,\n      last: null,\n    };\n\n    this.translations = {\n      maximizeTable: {\n        en: \"Maximize the table\",\n        ko: \"테이블 크기 최대화\",\n        jp: \"表の最大化表示\",\n        zh: \"最大化表\",\n        zh_cn: \"最大化表\",\n        fr: \"Agrandir Table\",\n        it: \"Visualizza la tabella a schermo pieno\",\n        es: \"Maximizar la tabla\",\n        de: \"Tabelle vergrößern\",\n        pt: \"Maximizar a tabela\",\n      },\n      closeFullscreen: {\n        en: \"Restore table to original size\",\n        ko: \"전체 화면 표시 닫기\",\n        jp: \"表の全画面表示の終了\",\n        zh: \"关闭全屏显示表\",\n        zh_cn: \"关闭全屏显示表\",\n        fr: \"Fermer Table Plein écran\",\n        it: \"Esci dalla modalità a schermo pieno\",\n        es: \"Minimizar la tabla\",\n        de: \"Vollbildtabelle schließen\",\n        pt: \"Fechar a tabela em tela cheia\",\n      },\n      sortAscending: {\n        en: \"Sort by ascending order\",\n        ko: \"Sort by ascending order\",\n        jp: \"Sort by ascending order\",\n        zh: \"Sort by ascending order\",\n        zh_cn: \"Sort by ascending order\",\n        fr: \"Sort by ascending order\",\n        it: \"Sort by ascending order\",\n        es: \"Sort by ascending order\",\n        de: \"Sort by ascending order\",\n        pt: \"Sort by ascending order\",\n      },\n      sortDescending: {\n        en: \"Sort by descending order\",\n        ko: \"Sort by descending order\",\n        jp: \"Sort by descending order\",\n        zh: \"Sort by descending order\",\n        zh_cn: \"Sort by descending order\",\n        fr: \"Sort by descending order\",\n        it: \"Sort by descending order\",\n        es: \"Sort by descending order\",\n        de: \"Sort by descending order\",\n        pt: \"Sort by descending order\",\n      },\n    };\n\n    // Ensure 'this' is tied to the component object in these member functions\n    const functionsToBind = [\n      \"_processLightDom\",\n      \"_rowAndColumnHighlight\",\n      \"_popstateListener\",\n      \"_toggleFullScreen\",\n      \"_sortData\",\n      \"_getCSSStyleSheetById\",\n      \"_checkForScroll\",\n      \"_handleEscPress\",\n      \"_getTranslatedString\",\n      \"setupFocusTrap\",\n      \"removeFocusTrap\",\n      \"_trapFocusInMaximizedTable\",\n    ];\n\n    for (let index = 0; index < functionsToBind.length; index++) {\n      const functionName = functionsToBind[index];\n      if (this[functionName]) {\n        this[functionName] = this[functionName].bind(this);\n      } else {\n        this.error(\"Tried to bind a function that doesn't exist\", functionName);\n      }\n    }\n\n    this._resizeListener = debounce(this._checkForScroll, this.resizeDebounce);\n    this._overlay.addEventListener(\"click\", () =>\n      this._toggleFullScreen(false)\n    );\n    this._fullScreenCloseButton.addEventListener(\"click\", () =>\n      this._toggleFullScreen(false)\n    );\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    // BEGIN DOM ACCESS\n\n    this._sortButtonBoilerplate = this.shadowRoot.querySelector(\n      \".rh-table__sort-button\"\n    );\n\n    // Make sure pointers are set\n    this.table = this.table ? this.table : this.querySelector(\"table\");\n    this._sortHeadings = this.table.querySelectorAll(\".sort-button\");\n\n    // check to see if the table has a top heading\n    this.topHeading = this.getAttribute(\"top-heading\");\n\n    // check to see if the table is sortable\n    this.sortable = this.getAttribute(\"sortable\");\n\n    // check to see if the full screen button is disabled\n    this.canFullScreen = this.stringToBool(this.getAttribute(\"full-screen\"));\n\n    // Make an unique id for use on table id, style tag id, etc.\n    const newId = Math.random().toString(36).substring(2, 9);\n    this.dataset.id = newId;\n    // If we don't have an ID on the table, set one\n    if (!this.id) {\n      this.id = `rh-table--${newId}`;\n    }\n\n    if (this.canFullScreen) {\n      window.addEventListener(\"resize\", this._resizeListener);\n      this._fullScreenButton.addEventListener(\"click\", () =>\n        this._toggleFullScreen(true)\n      );\n      this._expandButton.addEventListener('click', () => {\n        this._expandUnpressed = false;\n        if (this.classList.contains('rh-table--expanded-vertically')) {\n          this.classList.remove('rh-table--expanded-vertically');\n        }\n        else {\n          this.classList.add('rh-table--expanded-vertically');\n        }\n        this._checkForScroll();\n      });\n    }\n\n    // Get the docLang if it wasn't set and the doc has one\n    if (\n      !this.docLang &&\n      document &&\n      document.documentElement &&\n      document.documentElement.lang\n    ) {\n      this.docLang = document.documentElement.lang.toLowerCase();\n    }\n\n    // Add correct translation for expand text\n    const maximizeTableString = this._getTranslatedString(\"maximizeTable\");\n    if (this._fullScreenButton && maximizeTableString) {\n      this._fullScreenButton.setAttribute(\"title\", maximizeTableString);\n    } else {\n      this.warn(\n        \"Was unable to translate assistive text on maximize table button\"\n      );\n    }\n\n    // Add correct translation for collapse text\n    const closeFullscreenString = this._getTranslatedString(\"closeFullscreen\");\n    if (closeFullscreenString && this._fullScreenCloseButton) {\n      this._fullScreenCloseButton.setAttribute(\"title\", closeFullscreenString);\n    } else {\n      this.warn(\n        \"Was unable to translate assistive text on collapse table button\"\n      );\n    }\n\n    // fullScreenButton.value = `rh-table--${newId}`;\n\n    this._processLightDom();\n\n    // this.addEventListener(RhTable.events.sorted, this._sortedHandler);\n  }\n\n  disconnectedCallback() {\n    // this.removeEventListener(RhTable.events.sorted, this._sortedHandler);\n    this.table.removeEventListener(\"mouseover\", this._rowAndColumnHighlight);\n    window.removeEventListener(\"resize\", this._resizeListener);\n    this._overlay.removeEventListener(\"click\", () =>\n      this._toggleFullScreen(false)\n    );\n    this._fullScreenCloseButton.removeEventListener(\"click\", () =>\n      this._toggleFullScreen(false)\n    );\n  }\n\n  stringToBool(string) {\n    if (string === \"false\" || string === \"f\") {\n      return false;\n    } else {\n      return true;\n    }\n  }\n\n  /**\n   * Get trnaslated string\n   * @param {string} stringName The index value for the string in this.translations\n   * @returns Translated string\n   */\n  _getTranslatedString(stringName) {\n    if (\n      this.translations[stringName] &&\n      this.translations[stringName][this.docLang]\n    ) {\n      return this.translations[stringName][this.docLang];\n    } else if (\n      this.translations[stringName] &&\n      this.translations[stringName][\"en\"]\n    ) {\n      this.warn(`Could not get translated string for ${stringName}`);\n      return this.translations[stringName][\"en\"];\n    }\n    this.warn(\n      `Could not get translated string for ${stringName}, or english version, docLang is set to ${this.docLang}`\n    );\n  }\n\n  // Process the attribute change\n  // attributeChangedCallback(attr, oldValue, newValue) {\n  //   super.attributeChangedCallback(attr, oldValue, newValue);\n  // }\n\n  _trapFocusInMaximizedTable() {\n    if (this.isFullscreen) {\n    }\n  }\n\n  /**\n   * Keeps a keyboard user from getting outside of the maximzed table overlay\n   */\n  setupFocusTrap() {\n    const queryFirstFocusableElement = this.querySelector(\n      this._focusableElements\n    );\n    const lastFocusableElement = this._fullScreenCloseButton;\n    const firstFocusableElement = queryFirstFocusableElement\n      ? queryFirstFocusableElement\n      : this._fullScreenCloseButton;\n\n    // Set var so we can remove the listener later\n    this._previousFirstFocusableElement = firstFocusableElement;\n    // There is only one focusable element in the maximized table\n    if (firstFocusableElement === lastFocusableElement) {\n      this._focusTrapCallbacks.first = (event) => {\n        if (this.isFullscreen && event.key === \"Tab\") {\n          event.preventDefault();\n          firstFocusableElement.focus();\n        }\n      };\n      firstFocusableElement.addEventListener(\n        \"keydown\",\n        this._focusTrapCallbacks.first\n      );\n\n      this._focusTrapCallbacks.last = null;\n    } else {\n      // Setup first focusable element\n      this._focusTrapCallbacks.first = (event) => {\n        if (this.isFullscreen && event.key === \"Tab\" && event.shiftKey) {\n          event.preventDefault();\n          lastFocusableElement.focus();\n        }\n      };\n      firstFocusableElement.addEventListener(\n        \"keydown\",\n        this._focusTrapCallbacks.first\n      );\n\n      // Setup last focusable element\n      this._focusTrapCallbacks.last = (event) => {\n        if (this.isFullscreen && event.key === \"Tab\" && !event.shiftKey) {\n          event.preventDefault();\n          firstFocusableElement.focus();\n        }\n      };\n      lastFocusableElement.addEventListener(\n        \"keydown\",\n        this._focusTrapCallbacks.last\n      );\n    }\n  }\n\n  /**\n   * Remove event listeners for focus trap\n   */\n  removeFocusTrap() {\n    if (this._previousFirstFocusableElement && this._focusTrapCallbacks.first) {\n      this._previousFirstFocusableElement.removeEventListener(\n        \"keydown\",\n        this._focusTrapCallbacks.first\n      );\n    }\n    if (this._fullScreenCloseButton && this._focusTrapCallbacks.last) {\n      this._fullScreenCloseButton.removeEventListener(\n        \"keydown\",\n        this._focusTrapCallbacks.last\n      );\n    }\n  }\n\n  /**\n   * Catch when the URL has changed and close the full screen table if content isn't contained\n   */\n  _popstateListener() {\n    // Figure out if the URL update has a hash\n    if (location.hash) {\n      // If it does and the referenced element isn't in this table, close full screen\n      if (!this.querySelector(location.hash)) {\n        this._toggleFullScreen(false);\n      }\n    }\n  }\n\n  /**\n   * Open or close the full screen mode of the table\n   * @param {boolean} setToFullscreen Desired state\n   */\n  _toggleFullScreen(setToFullscreen) {\n    // Maximize table\n    if (setToFullscreen) {\n      // Make sure page layout doesn't change when table gets removed from document flow\n      this.style.height = `${this.offsetHeight}px`;\n      // @todo Retire non-BEM class\n      this.classList.add(\"full-screen\", \"rh-table--full-screen\");\n      document.body.classList.add(\"rh-table--is-full-screen\");\n      this._shadowWrapper.classList.add(\"table-full-screen\");\n      this._overlay.hidden = false;\n      window.addEventListener(\"keydown\", this._handleEscPress, true);\n      this.table.focus();\n      this.isFullscreen = true;\n      this.setupFocusTrap();\n      // Listener that closes full screen if a link outside of the table is clicked\n      window.addEventListener('popstate', this._popstateListener);\n    }\n    // Restore table to original size\n    else {\n      this.removeAttribute(\"style\");\n      // @todo Retire non-BEM class\n      this.classList.remove(\"full-screen\", \"rh-table--full-screen\");\n      document.body.classList.remove(\"rh-table--is-full-screen\");\n      this._shadowWrapper.classList.remove(\"table-full-screen\");\n      this._overlay.hidden = true;\n      window.removeEventListener(\"keydown\", this._handleEscPress, true);\n      this.removeFocusTrap();\n      window.removeEventListener('popstate', this._popstateListener);\n      this.isFullscreen = false;\n    }\n  }\n\n  /**\n   * Handle keyboard inputs\n   * @param {object} event Event object from event listener\n   */\n  _handleEscPress(event) {\n    if (event.defaultPrevented) {\n      return; // Do nothing if the event was already processed\n    }\n    switch (event.key) {\n      case \"Esc\": // IE/Edge specific value\n      case \"Escape\":\n        // check to see if table is full screen\n        if (this.isFullscreen) {\n          // if it is, close it\n          this._toggleFullScreen(false);\n        }\n        break;\n      default:\n        return; // Quit when this doesn't handle the key event.\n    }\n    // Cancel the default action to avoid it being handled twice\n    event.preventDefault();\n  }\n\n  /**\n   * Sort the data based on column heading\n   * @param {object} event Event object from event listener\n   */\n  _sortData(event) {\n    const thisCell = event.target.closest(\"td, th\");\n    let row, col;\n    if (thisCell) {\n      row = thisCell.dataset.row - 1;\n      col = thisCell.dataset.col - 1;\n    } else {\n      console.warn(\"Wasn't able to get column information to sort\");\n      return;\n    }\n\n    // check to see if this is re-sorting a row/col that has been sorted\n    // already to swap the direction of the values if it has\n    if (this.lastSortCol === col && this.sortOrder === \"az\") {\n      this.sortOrder = \"za\";\n    } else {\n      this.sortOrder = \"az\";\n    }\n    thisCell.classList.add(`sort-${this.sortOrder}`);\n    this.lastSortCol = col;\n\n    function checkIfLetters(value) {\n      const regex = RegExp(\"^d\");\n      return regex.test(value);\n    }\n    let sortedData;\n\n    if (this.sortOrder === \"az\") {\n      sortedData = this.tableSortValues.sort((a, b) => {\n        let aParam = a[col].innerText;\n        let bParam = b[col].innerText;\n        const aIsLetters = checkIfLetters(aParam);\n        const bIsLetters = checkIfLetters(bParam);\n        if (typeof aParam === \"string\" && aIsLetters && bIsLetters) {\n          aParam = aParam.toUpperCase(); // ignore upper and lowercase\n          bParam = bParam.toUpperCase(); // ignore upper and lowercase\n        }\n\n        if (aParam < bParam) {\n          return -1;\n        }\n        if (aParam > bParam) {\n          return 1;\n        }\n        // names must be equal\n        return 0;\n      });\n    } else if (this.sortOrder === \"za\") {\n      sortedData = this.tableSortValues.sort(function (a, b) {\n        let aParam = a[col].innerText;\n        let bParam = b[col].innerText;\n\n        const aIsLetters = checkIfLetters(aParam);\n        const bIsLetters = checkIfLetters(bParam);\n        if (typeof aParam === \"string\" && aIsLetters && bIsLetters) {\n          aParam = aParam.toUpperCase(); // ignore upper and lowercase\n          bParam = bParam.toUpperCase(); // ignore upper and lowercase\n        }\n\n        if (aParam < bParam) {\n          return 1;\n        }\n        if (aParam > bParam) {\n          return -1;\n        }\n        // names must be equal\n        return 0;\n      });\n    }\n\n    // wrapper for the rows\n    const wrapper = document.createElement(\"tbody\");\n\n    for (let rowIndex = 0; rowIndex < sortedData.length; rowIndex++) {\n      // make a new row to insert the cells\n      const rowWrapper = document.createElement(\"tr\");\n      const originalRow = sortedData[rowIndex][0].initialRow;\n      let rowData = Object.values(this.tableCellValues[originalRow]);\n      rowWrapper.append(...rowData);\n      wrapper.appendChild(rowWrapper);\n    }\n\n    // Update DOM state (classes, aria, etc)\n    if (this.sortOrder) {\n      const ariaSortedValue =\n        this.sortOrder === \"az\" ? \"descending\" : \"ascending\";\n      thisCell.setAttribute(\"aria-sort\", ariaSortedValue);\n\n      // Remove sorted-by on old headings\n      const sortedByHeadings = this.table.querySelectorAll(\n        \".rh-table__header--sorted-by\"\n      );\n      for (let index = 0; index < sortedByHeadings.length; index++) {\n        const sortedByHeading = sortedByHeadings[index];\n        sortedByHeading.classList.remove(\n          \"rh-table__header--sorted-by\",\n          \"rh-table__header--sorted-by--az\",\n          \"rh-table__header--sorted-by--za\"\n        );\n        sortedByHeading.removeAttribute(\"aria-sort\");\n      }\n\n      // Add it to our new cell\n      thisCell.classList.add(\"rh-table__header--sorted-by\");\n      const sortButton = thisCell.querySelector(\".rh-table__sort-button\");\n      let sortText;\n      switch (ariaSortedValue) {\n        case \"descending\":\n          sortText = this._getTranslatedString(\"sortAscending\");\n          if (sortButton && sortText)\n            sortButton.setAttribute(\"title\", sortText);\n          thisCell.classList.add(\"rh-table__header--sorted-by--za\");\n          break;\n        case \"ascending\":\n          sortText = sortText = this._getTranslatedString(\"sortDescending\");\n          if (sortButton && sortText)\n            sortButton.setAttribute(\"title\", sortText);\n          thisCell.classList.add(\"rh-table__header--sorted-by--az\");\n          break;\n      }\n    }\n\n    const tbody = this.querySelector(\"tbody\");\n    tbody.parentElement.replaceChild(wrapper, tbody);\n  }\n\n  /**\n   * Get the CSSSTyleSheet object by HTML Element's ID\n   * @param {string} stylesheetId HTML id of stylesheet element inDOM\n   * @returns {CSSStyleSheet} The CSSStyleSheet object associated with the HTML Element\n   */\n  _getCSSStyleSheetById(stylesheetId) {\n    const styleElement = this.querySelector(`#${stylesheetId}`);\n    if (styleElement && styleElement.sheet) {\n      return styleElement.sheet;\n    }\n  }\n\n  /**\n   * Removes all style rules from provided stylesheet\n   * @param {CSSSTyleSheet} stylesheet\n   */\n  _deleteAllRules(stylesheet) {\n    // Get rid of old styles\n    // Tried using a for loop, wasn't successful\n    while (stylesheet.cssRules.length > 0) {\n      stylesheet.deleteRule(0);\n    }\n  }\n\n  /**\n   * Function to highlight row, column, and currently hovered cell\n   * Uses the CSSOM to add styles instead of doing a bunch of DOM Updates\n   * @param {object} event Event object from event listener\n   */\n  _rowAndColumnHighlight(event) {\n    // Get the nearest table cell\n    let thisCell = event.target;\n    if (thisCell.tagName !== \"th\" || thisCell.tagName !== \"td\") {\n      thisCell = thisCell.closest(\"th, td\");\n    }\n    if (!thisCell) return;\n\n    // Get coordinates and add hover behavior\n    const row = thisCell.dataset.row;\n    const col = thisCell.dataset.col;\n    if (event.target && row && col) {\n      // If we're on the same cell as last time this was run we can avoid extra work\n      if ([row, col] === this.hovered.hoveredCoordinates) {\n        return;\n      }\n\n      this.hovered.hoveredCoordinates = [row, col];\n\n      if (this.hovered.checkInterval) {\n        clearInterval(this.hovered.checkInterval);\n      }\n\n      if (!this.hovered.styleElement) {\n        this.hovered.styleElement = document.createElement(\"style\");\n        this.hovered.styleElement.id = `hoverStyles--${this.dataset.id}`;\n        this.append(this.hovered.styleElement);\n        this.hovered.styleSheet = this._getCSSStyleSheetById(\n          this.hovered.styleElement.id\n        );\n      }\n\n      // Remove all previous styles\n      this._deleteAllRules(this.hovered.styleSheet);\n      // @todo Don't like hardcoding fallback colors in JS, not sure what a better option is though\n      const colHover = `#${this.id} [data-col=\"${col}\"] {\n          background: var(--rh-table--hoveredCol--Background, #EFF7FC);\n        }`;\n      const rowHover = `#${this.id} [data-row=\"${row}\"] {\n          background: var(--rh-table--hoveredRow--Background, #F3F3F3);\n        }`;\n      const intersectionHover = `#${this.id} [data-col=\"${col}\"][data-row=\"${row}\"] {\n          background: var(--rh-table--hoveredIntersection--Background, #E0EDF4)\n        }`;\n\n      // Add styles\n      this.hovered.styleSheet.insertRule(colHover, 0);\n      this.hovered.styleSheet.insertRule(rowHover, 1);\n      this.hovered.styleSheet.insertRule(intersectionHover, 2);\n\n      /**\n       * Remove row/col highlight if element is no longer hovered over\n       */\n      const hoverCheck = () => {\n        // Uses CSS pseudo state to see what element is currently hovered\n        const isHovered =\n          thisCell ===\n          thisCell.parentElement.querySelector(`[data-col=\"${col}\"]:hover`);\n        if (!isHovered) {\n          this._deleteAllRules(this.hovered.styleSheet);\n          this.hovered.hoveredCoordinates = null;\n          clearInterval(this.hovered.checkInterval);\n        }\n      };\n      this.hovered.checkInterval = setInterval(hoverCheck, 500);\n    }\n  }\n\n  /**\n   * Check to see if table scrolls, if so show/enable full screen functionality\n   */\n  _checkForScroll() {\n    const hasVerticalScroll = this._shadowWrapper.scrollHeight > this._shadowWrapper.clientHeight;\n    const hasHorizontalScroll = this._shadowWrapper.scrollWidth > this._shadowWrapper.clientWidth;\n    if (\n      this.table &&\n      this._shadowWrapper &&\n      hasVerticalScroll || hasHorizontalScroll\n    ) {\n      this.style.setProperty('--rh-table--scrollbar--width', `${this._shadowWrapper.offsetWidth - this._shadowWrapper.clientWidth}px`);\n      // Respects full screen option preference and minimize DOM changes\n      if (this.canFullScreen) {\n        if (this._fullScreenButton.hidden) this._fullScreenButton.hidden = false;\n        if (this._expandButton.hidden && hasVerticalScroll) this._expandButton.hidden = false;\n      }\n      // Check for attribute to minimize DOM changes\n      if (!this._shadowWrapper.hasAttribute('tabindex')) {\n        this._shadowWrapper.setAttribute('tabindex', '0');\n      }\n    } else {\n      // Don't hide expand and fullscreen if table can be un-expanded\n      if (this._expandUnpressed) {\n        // Check for attribute to minimize DOM changes\n        if (!this._fullScreenButton.hidden) this._fullScreenButton.hidden = true;\n        if (!this._expandButton.hidden) this._expandButton.hidden = true;\n      }\n      // Check for attribute to minimize DOM changes\n      if (this._shadowWrapper.hasAttribute('tabindex')) {\n        this._shadowWrapper.removeAttribute('tabindex');\n      }\n    }\n  }\n\n  /**\n   * Add HTML and behaviors necessary for sort\n   * @param {HTMLElement} columnHeader Sortable column header\n   */\n  _processSortableColumn(columnHeader) {\n    // Quick exit if it's been processed\n    if (columnHeader.classList.contains(\"sortable--processed\")) {\n      return;\n    }\n\n    const sortButton = this._sortButtonBoilerplate.cloneNode(\"true\");\n\n    // Remove hidden which is on the boilerplate\n    sortButton.hidden = false;\n\n    // Move any nodes (text node or Element) into the sort button\n    for (let index = 0; index < columnHeader.childNodes.length; index++) {\n      const childNode = columnHeader.childNodes[index];\n      sortButton.prepend(childNode);\n    }\n\n    // Add proper assistive text to the sort button\n    const sortText = this._getTranslatedString(\"sortDescending\");\n    if (sortButton && sortText) {\n      sortButton.setAttribute(\"title\", sortText);\n    }\n\n    // Add sort button to DOM and update column header\n    columnHeader.append(sortButton);\n    columnHeader.classList.add(\"sortable\");\n\n    sortButton.addEventListener(\"click\", this._sortData);\n\n    // Add our init class so we don't re-init\n    columnHeader.classList.add(\"sortable--processed\");\n  }\n\n  /**\n   * Get the table's data and update table's html\n   * Makes a copy of the table, enhance the copy, gets the data for sorting\n   */\n  _processLightDom() {\n    if (this.table && !this.classList.contains(\"rh-table--processed\")) {\n      //--------------------------------------------------\n      // Begin best time to manipulate the table's markup\n      // Modify elements when they're in not in the DOM yet\n      //--------------------------------------------------\n\n      const newTable = this.table.cloneNode(true);\n      this.tableSortValues = [];\n\n      // Set data attributes for column and row index\n      // Iterate over rows\n      const tableRows = newTable.querySelectorAll(\"tr\");\n      for (let rowIndex = 0; rowIndex < tableRows.length; rowIndex++) {\n        // @todo Handle row/col spanning\n        // Iterate over cells in each row\n        const tableRow = tableRows[rowIndex];\n        const tableCells = tableRow.querySelectorAll(\"td, th\");\n\n        let tableRowValues = [];\n        // if the table is sortable, this adds the rows to an object for sorting\n        if (this.sortable) {\n          this.tableCellValues[rowIndex] = Array.from(tableCells);\n        }\n        for (let colIndex = 0; colIndex < tableCells.length; colIndex++) {\n          const tableCell = tableCells[colIndex];\n\n          // Set col & row metadata\n          tableCell.dataset.row = rowIndex + 1;\n          tableCell.dataset.col = colIndex + 1;\n\n          if (tableCell.innerText.length > 75) {\n            tableCell.classList.add(\"content--lg\");\n          } else if (tableCell.innerText.length > 30) {\n            tableCell.classList.add(\"content--md\");\n          } else {\n            tableCell.classList.add(\"content--sm\");\n          }\n\n          // If the table isn't sortable, don't bother pulling any of the data for sorting\n          if (this.sortable) {\n            const sortableCols = this.sortable.split(\",\");\n\n            if (\n              rowIndex === 0 &&\n              sortableCols.includes((colIndex + 1).toString())\n            ) {\n              this._processSortableColumn(tableCell);\n            }\n\n            tableRowValues.push({\n              initialCol: colIndex,\n              initialRow: rowIndex,\n              innerText: tableCell.innerText.trim(),\n            });\n\n            // dump every cell into an object for lookup when sorting\n            this.tableCellValues[rowIndex][colIndex] = tableCell;\n          }\n        }\n        if (this.sortable) {\n          if (rowIndex !== 0) {\n            this.tableSortValues.push(tableRowValues);\n          }\n        }\n      }\n\n      //--------------------------------------------------\n      // End best time to manipulate the table's markup\n      //--------------------------------------------------\n      this.replaceChild(newTable, this.table);\n      this.table = newTable;\n\n      if (this.table) {\n        this._sortHeadings = this.table.querySelectorAll(\".sort-button\");\n      }\n\n      // Setup row/col hover effects\n      this.table.addEventListener(\"mouseover\", this._rowAndColumnHighlight);\n      this._checkForScroll();\n      this.classList.add(\"rh-table--processed\");\n    }\n  }\n\n  // _sortedHandler(event) {\n  //   this.emitEvent(RhTable.events.sorted, {\n  //     detail: {},\n  //   });\n  // }\n}\n\nPFElement.create(RhTable);\n\nexport default RhTable;\n"],"names":["debounce","func","delay","immediate","timeout","context","args","arguments","later","apply","callNow","clearTimeout","setTimeout","RhTable","sorted","tag","PFElement","PfeTypes","Content","type","PfeType","table","_shadowWrapper","shadowRoot","getElementById","canFullScreen","isFullscreen","_fullScreenButton","querySelector","_expandButton","_fullScreenCloseButton","_overlay","_expandUnpressed","hovered","hoveredCoordinates","styleElement","styleSheet","checkInterval","docLang","_sortHeadings","tableSortValues","heading","values","tableCellValues","sortable","lastSortCol","resizeDebounce","sortOrder","_focusableElements","_previousFirstFocusableElement","_focusTrapCallbacks","first","last","translations","maximizeTable","en","ko","jp","zh","zh_cn","fr","it","es","de","pt","closeFullscreen","sortAscending","sortDescending","functionsToBind","index","length","functionName","bind","error","_resizeListener","_checkForScroll","addEventListener","_toggleFullScreen","_sortButtonBoilerplate","querySelectorAll","topHeading","getAttribute","stringToBool","newId","Math","random","toString","substring","dataset","id","window","classList","contains","remove","add","document","documentElement","lang","toLowerCase","maximizeTableString","_getTranslatedString","setAttribute","warn","closeFullscreenString","_processLightDom","removeEventListener","_rowAndColumnHighlight","string","stringName","queryFirstFocusableElement","lastFocusableElement","firstFocusableElement","event","key","preventDefault","focus","shiftKey","location","hash","setToFullscreen","style","height","offsetHeight","body","hidden","_handleEscPress","setupFocusTrap","_popstateListener","removeAttribute","removeFocusTrap","defaultPrevented","thisCell","target","closest","row","col","console","checkIfLetters","value","regex","RegExp","test","sortedData","sort","a","b","aParam","innerText","bParam","aIsLetters","bIsLetters","toUpperCase","wrapper","createElement","rowIndex","rowWrapper","originalRow","initialRow","rowData","Object","append","appendChild","ariaSortedValue","sortedByHeadings","sortedByHeading","sortButton","sortText","tbody","parentElement","replaceChild","stylesheetId","sheet","stylesheet","cssRules","deleteRule","tagName","clearInterval","_getCSSStyleSheetById","_deleteAllRules","colHover","rowHover","intersectionHover","insertRule","hoverCheck","isHovered","setInterval","hasVerticalScroll","scrollHeight","clientHeight","hasHorizontalScroll","scrollWidth","clientWidth","setProperty","offsetWidth","hasAttribute","columnHeader","cloneNode","childNodes","childNode","prepend","_sortData","newTable","tableRows","tableRow","tableCells","tableRowValues","Array","from","colIndex","tableCell","sortableCols","split","includes","_processSortableColumn","push","initialCol","trim","create"],"mappings":"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"}